define(["jquery","template","components","ZeroClipboard","jqueryValidate","ueditorConfig","ueditorAll","manageCommon"],function(a,i,e,o,l,s,c,t){function d(){var a=!1,i=!1,o=!1,l=!1,s=!1,c=!1;e.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(e){if(1==e.res)for(var t=e.obj,d=0;d<t.length;d++){var r=t[d],n=r.moduleId;r.parentId;7==n&&($("#goodsList").css("display","block"),a=!0),8==n&&($("#goodsOrder").css("display","block"),a=!0),9==n&&($("#goodsCatory").css("display","block"),a=!0),10==n&&($("#memberManage").css("display","block"),i=!0),11==n&&($("#messageManage").css("display","block"),i=!0),12==n&&($("#articleManage").css("display","block"),o=!0),13==n&&($("#adManage").css("display","block"),l=!0),14==n&&($("#goodsReport").css("display","block"),s=!0),15==n&&($("#orderReport").css("display","block"),s=!0),16==n&&($("#adminManage").css("display","block"),c=!0),17==n&&($("#roleManage").css("display","block"),c=!0),a&&$("#div1").css("display","block"),i&&$("#div2").css("display","block"),o&&$("#div3").css("display","block"),l&&$("#div4").css("display","block"),s&&$("#div5").css("display","block"),c&&$("#div6").css("display","block"),(a||i||o&&l||s||c)&&$(".container-wrap").css("display","block")}})}function r(){$("#div-box").on("change","#pic-upload",function(){var a=new FormData;a.append("param",""),a.append("file",$("#pic-upload")[0].files[0]);var i=apiUrl+"/upload/uploadimg/dydz/user";alert(i),$.ajax({url:i,type:"POST",dataType:"json",data:a,processData:!1,contentType:!1,success:function(a){var i='<li picUrl="'+a.imageUrl+'"class="apply-book"> <img  src=" '+apiUrlPic+a.imageUrl+'"> <a docUrl="'+a.imageUrl+'" href="javascript:void(0)" class="text-basic del-doc iconfont icon-close"></a></li>';$("#pic-document-list").append(i),m+=1,1==m&&$(".a-upload").css("display","none")}})})}function n(){$("#div-box").on("click",".del-doc",function(){var a=$(this).parents("li"),i=apiUrl+"/upload/removeFile",e=a.attr("picUrl");$.ajax({url:i,type:"get",dataType:"json",data:{preImg:e},success:function(i){1==i.res&&(a.remove(),m-=1,m<1&&$(".a-upload").css("display","block"))}})})}function p(a){var o=apiUrl+"/admin/article/articleAdmin/getArticleById?articleId="+a;e.getMsg(o).done(function(a){var e=a.res;if(console.log(a.obj),1==e){var o=i("div-box-tpl",a);if(document.getElementById("div-box").innerHTML=o,""!=a.obj.image){var l=a.obj.imageUrl;$(".a-upload").css("display","none");var s=apiUrlPic+l;console.log(l),$("#pic-document-list").append($('<li picUrl="'+l+'"class="apply-book"> <img  src=" '+s+'"> <a docUrl="'+l+'" href="javascript:void(0)" class="text-basic del-doc iconfont icon-close"></a></li>'))}g.ready(function(){g.setContent(a.obj.content)})}})}function u(){$("#form-box").validate({rules:{title:{required:!0,maxlength:50},recommend:{required:!0}},messages:{title:{required:"文章名称必填",maxlength:"最多填写50个字符"},recommend:{required:"请选择一个"}},submitHandler:function(a){100*$("#price").val();$("#pic-document-list > li").each(function(){v+=$(this).attr("picUrl")+","});var i=/,$/gi;v=v.replace(i,"");var o=$("#form-box").serialize()+"&imageUrl="+v;e.getMsg(y,o,"post").done(function(a){console.log(a),1==a.res&&(e.Alert("success","修改成功"),setTimeout(function(){window.history.go(-1)},2e3))})}})}d(),window.ZeroClipboard=o;var m=0,g=UE.getEditor("container",{initialFrameWidth:800,initialFrameHeight:250}),b=e.GetQueryString("id"),y="",v="";b?(y=apiUrl+"/admin/article/articleAdmin/editArticle?articleId="+b,p(b),$("#addState").text("编辑文章")):(y=apiUrl+"/admin/article/articleAdmin/addArticle",$("#addState").text("添加文章")),r(),n(),u()});