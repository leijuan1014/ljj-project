define(["jquery","template","components","jqueryValidate","manageCommon"],function(e,o,l,s,a){function d(){var e=!1,o=!1,s=!1,a=!1,d=!1,i=!1;l.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(l){if(1==l.res)for(var n=l.obj,r=0;r<n.length;r++){var t=n[r],c=t.moduleId;t.parentId;7==c&&($("#goodsList").css("display","block"),e=!0),8==c&&($("#goodsOrder").css("display","block"),e=!0),9==c&&($("#goodsCatory").css("display","block"),e=!0),10==c&&($("#memberManage").css("display","block"),o=!0),11==c&&($("#messageManage").css("display","block"),o=!0),12==c&&($("#articleManage").css("display","block"),s=!0),13==c&&($("#adManage").css("display","block"),a=!0),14==c&&($("#goodsReport").css("display","block"),d=!0),15==c&&($("#orderReport").css("display","block"),d=!0),16==c&&($("#adminManage").css("display","block"),i=!0),17==c&&($("#roleManage").css("display","block"),i=!0),e&&$("#div1").css("display","block"),o&&$("#div2").css("display","block"),s&&$("#div3").css("display","block"),a&&$("#div4").css("display","block"),d&&$("#div5").css("display","block"),i&&$("#div6").css("display","block"),(e||o||s&&a||d||i)&&$(".container-wrap").css("display","block")}})}function i(e){var s=apiUrl+"/admin/role/role/getRoleInfo?roleId="+e;l.getMsg(s).done(function(e){var l=e.res;if(1==l){var s=o("div-box-tpl",e);document.getElementById("div-box").innerHTML=s}}),s=apiUrl+"/admin/module/module/queryAllValidModule?roleId="+r,l.getMsg(s).done(function(e){var o=e.res;if(1==o)for(var l=e.obj,s=0;s<l.length;s++){var a=l[s];if(0==a.parentId){var d='<div style="width: 13%; float: left;  margin: 0 0 0 3%;" id="module_'+a.moduleId+'"><h4 style="background: grey;text-align:center;color: white;height: 40px;">'+a.name;$("#div-module").append(d)}else{var d='<ul><li><input  style="float:left;margin:5% 10% 0 0 ;heith" value="'+a.moduleId+'" name="moduleGroups" type="checkbox" ';1==a.isOwnered&&(d+="checked"),d+="><a>"+a.name+"&nbsp;&nbsp;&nbsp;</a></li></ul>",$("#module_"+a.parentId).append(d)}}})}function n(){$("#form-box").validate({submitHandler:function(e){for(var o=document.getElementsByName("moduleGroups"),s="",a=0;a<o.length;a++)o[a].checked&&(0!=s.length&&(s+=","),s+=o[a].value);var d={roleId:r,moduleIds:s};l.getMsg(t,d,"post").done(function(e){1==e.res?(l.Alert("success","权限分配成功"),setTimeout(function(){window.history.go(-1)},2e3)):l.Alert("success","失败")})}})}d();var r=l.GetQueryString("id"),t=apiUrl+"/admin/role/role/grantModules";i(r),n()});