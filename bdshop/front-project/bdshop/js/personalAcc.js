define(["jquery","components","common","template","weui"],function(e,t,n,a,o){function r(){t.getMsg(apiUrl+"/front/user/user/getUserById").done(function(e){var t=e.res;if(1==t){e=e.obj;var n=a("user-info-tpl",e);$("#user-info").html(n),u()}})}function i(){$("#user-info").on("change","#uploaderInput",function(){var e=new FormData;e.append("param",""),e.append("file",$("#uploaderInput")[0].files[0]);var t=apiUrl+"/upload/uploadimg/dydz/user";$.ajax({url:t,type:"POST",dataType:"json",data:e,processData:!1,contentType:!1,success:function(e){s(e.imageUrl)}})})}function s(e){e=apiUrlPic+e;var n={headimgurl:e},a=apiUrl+"/front/user/user/updateUser";t.getMsg(a,n,"POST").done(function(e){var t=e.res;1==t&&(window.location.href="/pages/bdshop/page/personalAcc.html")})}function u(){$("#phone").blur(function(){var e=$(this).val();e.replace(/[^\x00-xff]/g,"xx").length;var t=/^1([3578]\d|4[57])\d{8}$/;0==e?($.toast("请输入手机号码","text"),p=!1,c="请输入手机号码"):t.test(e)?p=!0:($.toast("手机格式错误","text"),p=!1,c="手机格式错误")})}r(),$("#index-menu li").eq(2).addClass("active");$("#order-box");i(),$("#user-info").on("click","#save",function(){var e=$("#phone").val(),n=$("#nickname").val(),a=apiUrl+"/front/user/user/updateUser",o={phone:e,nickname:n};e?n?t.getMsg(a,o,"POST").done(function(e){var t=e.res;1==t&&($.toast("保存成功！","text"),setTimeout(function(){window.history.go(-1)},2e3))}):$.toast("请填写昵称","text"):$.toast(c,"text")});var p=!1,c="请输入手机号码"});