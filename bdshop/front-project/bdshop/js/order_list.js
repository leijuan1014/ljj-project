define(["jquery","components","common","template","weui"],function(e,t,i,a,o){var s=$("#order-box"),d=$("#weui-loadmore"),r=$("#weui-none"),n="",l=null,g=null;$("#order-list").on("click","a",function(){n=$(this).attr("state"),p.page=1,$(this).find("div").addClass("active_div").parent().siblings().find("div").removeClass("active_div"),setTimeout(p.d(p.page,p.size),2e3)}),$("#logisticsState").change(function(){g=$("#logisticsState").val(),p.page=1,setTimeout(p.d(p.page,p.size),2e3)}),$("#paymentId").change(function(){l=$("#paymentId").val(),p.page=1,setTimeout(p.d(p.page,p.size),2e3)});var p={page:0,size:10,cid:"",isLoading:!1,getMore:function(e){p.isLoading||(e?(p.page=1,r.hide(),$("#newListBox").html("")):p.page+=1,d.show(),p.isLoading=!0,setTimeout(p.d(p.page,p.size),2e3))},d:function(e,i){var o={payState:n,paymentId:l,logisticsState:g,pageNo:e,pageSize:i};t.getMsg(apiUrl+"/front/order/order/getOrderByPage?pageSize=4",o).done(function(e){var t=e.res;if(0!==t){e=e.obj;for(var i=0;i<e.dataList.length;i++){null!=e.dataList[i].orderDetailsList&&e.dataList[i].orderDetailsList.length>0&&(e.dataList[i].goodsName=e.dataList[i].orderDetailsList[0].goodsName),e.dataList[i].totalAmount=e.dataList[i].totalAmount/100;for(var o=0;o<e.dataList[i].orderDetailsList.length;o++){console.log(e.dataList[i].orderDetailsList[o].image);var n,l=e.dataList[i].orderDetailsList[o].image;l.length>0&&(n=l.split(","),n.length>0&&(e.dataList[i].orderDetailsList[o].image=apiUrlPic+n[0]))}}var g=e.dataList,c=a("order-box-tpl",e);g&&g.length>0?(p.isLoading=!1,r.hide()):(p.isLoading=!0,r.show()),p.page>1?s.append(c):s.html(c),d.hide()}else s.html(""),r.show(),d.hide()})}};$(window).scroll(function(){$(document).scrollTop()+$(window).height()+100>=$(document).height()&&p.getMore(!1)}),p.getMore(!0),$("#order-box").on("click",".send-modal",function(){var e=$(this).attr("oNum");url=apiUrl+"/front/order/order/buyGoodsAgain?orderNumber="+e,t.getMsg(url).done(function(e){var t=e.res;1==t?window.location.href="/pages/bdshop/page/order_submit.html":$.toast("购买失败","text")})})});