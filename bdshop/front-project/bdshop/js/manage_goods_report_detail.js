define(["jquery","components","bootstrap","manageCommon","jqueryValidate","highcharts"],function(jquery,components,bootstrap,manageCommon,jqueryValidate,highcharts){function getModules(){var e=!1,t=!1,a=!1,s=!1,i=!1,o=!1;components.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(r){if(1==r.res)for(var d=r.obj,l=0;l<d.length;l++){var n=d[l],c=n.moduleId;n.parentId;7==c&&($("#goodsList").css("display","block"),e=!0),8==c&&($("#goodsOrder").css("display","block"),e=!0),9==c&&($("#goodsCatory").css("display","block"),e=!0),10==c&&($("#memberManage").css("display","block"),t=!0),11==c&&($("#messageManage").css("display","block"),t=!0),12==c&&($("#articleManage").css("display","block"),a=!0),13==c&&($("#adManage").css("display","block"),s=!0),14==c&&($("#goodsReport").css("display","block"),i=!0),15==c&&($("#orderReport").css("display","block"),i=!0),16==c&&($("#adminManage").css("display","block"),o=!0),17==c&&($("#roleManage").css("display","block"),o=!0),e&&$("#div1").css("display","block"),t&&$("#div2").css("display","block"),a&&$("#div3").css("display","block"),s&&$("#div4").css("display","block"),i&&$("#div5").css("display","block"),o&&$("#div6").css("display","block"),(e||t||a&&s||i||o)&&$(".container-wrap").css("display","block")}})}function initData(e,t,a){var s="";s=s+"goodsName="+e+"&createTime_le="+t+"&createTime_ge="+a;var i=listUrl;components.getMsg(i,s,"post").done(function(e){var s=e.res;if(1==s&&(e.dataList=e.list,void 0!=e.dataList&&e.dataList.length>0)){for(var i=0;i<e.dataList.length;i++)e.dataList[i].createTime=components.formatDate(e.dataList[i].createTime),e.dataList[i].detailsAmount=e.dataList[i].detailsAmount/100;for(var o="",r="",d="",l="",n="",c="",m="",g="",p=GetDateDiff(a,t),u=new Date(Date.parse(a.replace(/-/g,"/"))),i=0,h=0;h<p;h++){var u=new Date(Date.parse(a.replace(/-/g,"/")));u.setDate(u.getDate()+h),u=u.Format("yyyy-MM-dd");var r="",l="",c="";i<e.dataList.length&&u==e.dataList[i].createTime?(r=e.dataList[i].createTime,l=e.dataList[i].num,c=e.dataList[i].detailsAmount,g=e.dataList[i].unitName,m=e.dataList[i].goodsName,i++):(r=u,l=0,c=0),o=o+=",'"+r+"'",d=d+=","+l,n=n+=","+c}o=o.substring(1),o="["+o+"]",d=d.substring(1),d="["+d+"]",n=n.substring(1),n="["+n+"]",showDetailReport(m,g,o,d,n)}})}function showDetailReport(goodsName,unitName,createTime,num,detailsAmount){void 0!=goodsName&&void 0!=unitName&&void 0!=createTime&&void 0!=num&&void 0!=detailsAmount&&$("#reportdetail").highcharts({title:{text:goodsName+"("+unitName+")",x:-20},credits:{text:"",href:""},subtitle:{text:"",x:-20},xAxis:{categories:eval(createTime),plotLines:[{value:-1,width:1,dashStyle:"solid",color:"red"}]},yAxis:{title:{text:"销售量/销售额"}},tooltip:{valueSuffix:""},legend:{layout:"horizontal",align:"center",verticalAlign:"bottom",borderWidth:1},series:[{name:"销售额(元)",data:eval(detailsAmount)},{name:"销售量("+unitName+")",data:eval(num)}]})}function GetDateDiff(e,t){var a=new Date(Date.parse(e.replace(/-/g,"/"))).getTime(),s=new Date(Date.parse(t.replace(/-/g,"/"))).getTime(),i=Math.abs(a-s)/864e5;return parseInt(i)}getModules(),listUrl=apiUrl+"/admin/order/orderAdmin/getDetailReportByOrderDetailsAdminSearchVO";var goodsName=components.GetQueryString("goodsName"),createTime_le=components.GetQueryString("createTime_le"),createTime_ge=components.GetQueryString("createTime_ge");void 0!=goodsName&&""!=goodsName&&void 0!=createTime_le&&""!=createTime_le&&void 0!=createTime_ge&&""!=createTime_ge&&(initData(goodsName,createTime_le,createTime_ge),Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e})});