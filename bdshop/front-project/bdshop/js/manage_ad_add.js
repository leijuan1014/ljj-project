define(["jquery","template","components","ZeroClipboard","jqueryValidate","ueditorConfig","ueditorAll","manageCommon"],function(a,i,e,s,d,o,l,c){function r(){var a=!1,i=!1,s=!1,d=!1,o=!1,l=!1;e.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(e){if(1==e.res)for(var c=e.obj,r=0;r<c.length;r++){var t=c[r],n=t.moduleId;t.parentId;7==n&&($("#goodsList").css("display","block"),a=!0),8==n&&($("#goodsOrder").css("display","block"),a=!0),9==n&&($("#goodsCatory").css("display","block"),a=!0),10==n&&($("#memberManage").css("display","block"),i=!0),11==n&&($("#messageManage").css("display","block"),i=!0),12==n&&($("#articleManage").css("display","block"),s=!0),13==n&&($("#adManage").css("display","block"),d=!0),14==n&&($("#goodsReport").css("display","block"),o=!0),15==n&&($("#orderReport").css("display","block"),o=!0),16==n&&($("#adminManage").css("display","block"),l=!0),17==n&&($("#roleManage").css("display","block"),l=!0),a&&$("#div1").css("display","block"),i&&$("#div2").css("display","block"),s&&$("#div3").css("display","block"),d&&$("#div4").css("display","block"),o&&$("#div5").css("display","block"),l&&$("#div6").css("display","block"),(a||i||s&&d||o||l)&&$(".container-wrap").css("display","block")}})}function t(a){var s=apiUrl+"/admin/ad/ad/queryAdByAdId?adId="+a;e.getMsg(s).done(function(a){var e=a.res;if(1==e){var s=i("div-box-tpl",a);if(document.getElementById("div-box").innerHTML=s,""!=a.obj.image){var d=a.obj.image;$(".a-upload").css("display","none");var o=apiUrlPic+d;$("#pic-document-list").append($('<li picUrl="'+d+'"class="apply-book"> <img  src=" '+o+'">  <a docUrl="'+d+'" href="javascript:void(0)" class="text-basic del-doc"><i class="iconfont icon-delete"></i></a></li>'))}}})}function n(){$("#div-box").on("change","#pic-upload",function(){var a=new FormData;a.append("param",""),a.append("file",$("#pic-upload")[0].files[0]);var i=apiUrl+"/upload/uploadimg/dydz/user";$.ajax({url:i,type:"POST",dataType:"json",data:a,processData:!1,contentType:!1,success:function(a){var i='<li picUrl="'+a.imageUrl+'"class="apply-book"> <img  src=" '+apiUrlPic+a.imageUrl+'">  <a docUrl="'+a.imageUrl+'" href="javascript:void(0)" class="text-basic del-doc"><i class="iconfont icon-delete"></i></a></li>';$("#pic-document-list").append(i),$(".a-upload").css("display","none")}})})}function p(){$("#div-box").on("click",".del-doc",function(){var a=$(this),i=apiUrl+"/upload/removeFile",e=a.attr("docUrl");$.ajax({url:i,type:"get",dataType:"json",data:"preImg="+e,success:function(i){1==i.res&&a.parents("li").remove()}})})}function u(){$("#form-box").validate({rules:{state:{required:!0},description:{required:!0}},messages:{state:{required:"请选择一个"},description:{required:"简要描述请填写"}},submitHandler:function(a){$("#pic-document-list > li").each(function(){b+=$(this).attr("picUrl")+","});var i=/,$/gi;b=b.replace(i,"");var s=$("#form-box").serialize()+"&image="+b;e.getMsg(y,s,"post").done(function(a){1==a.res?(e.Alert("success","添加成功"),setTimeout(function(){window.history.go(-1)},2e3)):e.Alert("success","失败")})}})}r();var m=e.GetQueryString("id"),g=e.GetQueryString("adid"),y="",b="";m?(y=apiUrl+"/admin/ad/ad/editAd?adId="+m,$("#addState").text("编辑广告"),t(m)):(y=apiUrl+"/admin/ad/ad/addAd?adPositionId="+g,$("#addState").text("添加广告")),n(),p(),u()});