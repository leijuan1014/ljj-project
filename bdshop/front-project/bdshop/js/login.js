define(["jquery","components","common","weui"],function(e,o,n,s){function a(t){return t.replace(/[^\x00-xff]/g,"xx").length}function r(e){0==v?(e.text("重新发送"),clearTimeout(t),u=!0):(e.text("重新发送("+v+")"),v--,t=setTimeout(function(){r(e)},1e3))}var i=!1,c=!1,u=!0,f="请输入手机号码",d="请输入您的验证码",x=$("#phone"),l=$("#auto-code"),v=60;$("#code-btn").click(function(t){t.preventDefault();var e=x.val(),e=x.val(),n=(l.val(),/^1([3578]\d|4[57])\d{8}$/);0==a(e)?(i=!1,f="请输入手机号码"):n.test(e)?i=!0:(i=!1,f="手机格式错误"),$this=$(this),i&&u?o.getMsg(apiUrl+"/front/user/user/sendCode","phone="+e,"post").done(function(t){var e=t.res;1==e?($.toast("发送成功","text"),u=!1,v=60,r($this)):303==e?$.toast("操作频繁","text"):$.toast("请求失败","text")}):i||$.toast(f,"text")}),$("#bind-btn").click(function(t){t.preventDefault();var e=x.val(),n=l.val(),s=/^1([3578]\d|4[57])\d{8}$/;0==a(e)?(i=!1,f="请输入手机号码"):s.test(e)?i=!0:(i=!1,f="手机格式错误");var s=/^[1-9]\d{5}$/;0==a(n)?(c=!1,d="请输入您的验证码"):s.test(n)?c=!0:(c=!1,d="验证码格式错误"),i?c?o.getMsg(apiUrl+"/front/user/user/checkCode","phone="+e+"&code="+n,"post").done(function(t){var e=t.res;401==e||411==e?$.toast("验证码错误","text"):503==e?$.toast("请求超时","text"):($.toast("登录成功","text"),setTimeout(function(){history.go(-1)},3e3))}):$.toast(d,"text"):$.toast(f,"text")})});