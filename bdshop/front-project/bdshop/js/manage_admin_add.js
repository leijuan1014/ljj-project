define(["jquery","template","components","jqueryValidate","cityPicker","cityselect","manageCommon"],function(e,s,a,i,d,r,o){function n(){var e=!1,s=!1,i=!1,d=!1,r=!1,o=!1;a.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(a){if(1==a.res)for(var n=a.obj,t=0;t<n.length;t++){var l=n[t],c=l.moduleId;l.parentId;7==c&&($("#goodsList").css("display","block"),e=!0),8==c&&($("#goodsOrder").css("display","block"),e=!0),9==c&&($("#goodsCatory").css("display","block"),e=!0),10==c&&($("#memberManage").css("display","block"),s=!0),11==c&&($("#messageManage").css("display","block"),s=!0),12==c&&($("#articleManage").css("display","block"),i=!0),13==c&&($("#adManage").css("display","block"),d=!0),14==c&&($("#goodsReport").css("display","block"),r=!0),15==c&&($("#orderReport").css("display","block"),r=!0),16==c&&($("#adminManage").css("display","block"),o=!0),17==c&&($("#roleManage").css("display","block"),o=!0),e&&$("#div1").css("display","block"),s&&$("#div2").css("display","block"),i&&$("#div3").css("display","block"),d&&$("#div4").css("display","block"),r&&$("#div5").css("display","block"),o&&$("#div6").css("display","block"),(e||s||i&&d||r||o)&&$(".container-wrap").css("display","block")}})}function t(){var e=apiUrl+"/admin/role/role/queryRoleByPage";a.getMsg(e).done(function(e){var a=e.res;if(1==a){e=e.obj;var i=s("role-tp-1",e);document.getElementById("role-tp").innerHTML=i}})}function l(e){var i=apiUrl+"/admin/admin/adminUser/getAdminInfo?adminId="+e;a.getMsg(i).done(function(e){var i,d=e.res;if(1==d){i=e.obj;var r=s("div-box-tpl",e);document.getElementById("div-box").innerHTML=r;var o={url:"/pages/bdshop/libs/city.min.js",prov:null,city:null,dist:null,nodata:null,required:!1};$("#editAdress").citySelect(o);var n=apiUrl+"/admin/role/role/queryRoleByPage";a.getMsg(n).done(function(e){var s=e.res;if(1==s){for(var a,e=e.obj,d=0;d<e.dataList.length;d++)a+=e.dataList[d].roleId==i.role.roleId?"<option value='"+e.dataList[d].roleTypeId+"'  selected >"+e.dataList[d].name+"</option>":"<option value='"+e.dataList[d].roleTypeId+"'>"+e.dataList[d].name+"</option>";$("#roleList").append(a)}})}})}function c(){$("#form-box").validate({rules:{state:{required:!0},adminName:{required:!0},password:{required:!0,minlength:6},lastpass:{required:!0,minlength:6,equalTo:"#passWd"},companyName:{required:!0},description:{required:!0}},messages:{state:{required:"请选择一个"},adminName:{required:"管理账号名称"},password:{required:"密码请填写",minlength:"密码长度不能小于 6 个字符"},lastpass:{required:"请输入密码",minlength:"密码长度不能小于 6 个字符",equalTo:"两次密码输入不一致"},companyName:{required:"公司名称请填写"},description:{required:"简要描述请填写"}},submitHandler:function(e){var s=$("#form-box").serialize();a.getMsg(m,s,"post").done(function(e){1==e.res?(a.Alert("success","添加成功"),setTimeout(function(){window.history.go(-1)},2e3)):410==e.res?a.Alert("success","管理账号名称已存在"):411==e.res?a.Alert("success","管理账号名称已存在"):a.Alert("success","失败")})}})}n();var p=a.GetQueryString("id"),m="";p?(m=apiUrl+"/admin/admin/adminUser/editAdmin?adminId="+p,$("#addState").text("编辑管理员"),l(p)):(m=apiUrl+"/admin/admin/adminUser/addAdmin",$("#addState").text("添加管理员"),t()),c()});