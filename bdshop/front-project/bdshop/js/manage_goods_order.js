define(["jquery","template","components","bootstrap","jqueryValidate","paginator","manageCommon"],function(e,a,t,i,o,r,n){function s(){var e=!1,a=!1,i=!1,o=!1,r=!1,n=!1;t.getMsg(apiUrl+"/admin/module/module/queryModules").done(function(t){if(1==t.res)for(var s=t.obj,l=0;l<s.length;l++){var d=s[l],c=d.moduleId;d.parentId;7==c&&($("#goodsList").css("display","block"),e=!0),8==c&&($("#goodsOrder").css("display","block"),e=!0),9==c&&($("#goodsCatory").css("display","block"),e=!0),10==c&&($("#memberManage").css("display","block"),a=!0),11==c&&($("#messageManage").css("display","block"),a=!0),12==c&&($("#articleManage").css("display","block"),i=!0),13==c&&($("#adManage").css("display","block"),o=!0),14==c&&($("#goodsReport").css("display","block"),r=!0),15==c&&($("#orderReport").css("display","block"),r=!0),16==c&&($("#adminManage").css("display","block"),n=!0),17==c&&($("#roleManage").css("display","block"),n=!0),e&&$("#div1").css("display","block"),a&&$("#div2").css("display","block"),i&&$("#div3").css("display","block"),o&&$("#div4").css("display","block"),r&&$("#div5").css("display","block"),n&&$("#div6").css("display","block"),(e||a||i&&o||r||n)&&$(".container-wrap").css("display","block")}})}function l(e){var i=apiUrl+"/admin/order/orderAdmin/getOrderByOrderNumber?orderNumber="+e;t.getMsg(i,"post").done(function(e){var i=e.res;if(1==i)if(3!=h){$("#orderinfo").css("display","none");var o=a("logisticsInfo-tpl",e);document.querySelector("#logisticsInfo").innerHTML=o;var r=a("table-list-tpl2",e);document.querySelector("#table-list-content2").innerHTML=r}else{$("#info").css("display","none");var o=a("orderinfo-tpl",e);document.querySelector("#orderinfo").innerHTML=o}else t.Alert("","出错了！")})}function d(e){var i=apiUrl+"/admin/order/orderAdmin/getOrderByOrderNumber?orderNumber="+e;t.getMsg(i,"post").done(function(e){var i=e.res;if(1==i){var o=a("orderinfo-tpl",e);document.querySelector("#orderinfo").innerHTML=o}else t.Alert("","出错了！")})}function c(){$("#orderinfo").on("change","#pic-upload",function(){var e=new FormData;e.append("param",""),e.append("file",$("#pic-upload")[0].files[0]);var a=apiUrl+"/upload/uploadimg/dydz/user";$.ajax({url:a,type:"POST",dataType:"json",data:e,processData:!1,contentType:!1,success:function(e){var a='<li picUrl="'+e.result+'"class="apply-book"> <img  src=" '+apiUrlPic+e.result+'"> <a docUrl="'+e.result+'" href="javascript:void(0)" class="text-basic del-doc iconfont icon-close"></a></li>';$("#pic-document-list").append(a)}})})}function p(){$("#orderinfo").on("click",".del-doc",function(){var e=$(this),a=apiUrl+"/upload/removeFile",t=e.attr("picUrl");$.ajax({url:a,type:"get",dataType:"json",data:"preImg="+t,success:function(a){1==a.res&&e.parents("li").remove()}})})}function u(){$("#rePw").validate({rules:{},messages:{},submitHandler:function(e){$("#pic-document-list > li").each(function(){M+=$(this).attr("picUrl")+","});var a=/,$/gi;M=M.replace(a,"");var i=$("#rePw").serialize();3==h&&(i+="&imageUrl="+M),t.getMsg(k,i,"post").done(function(e){1==e.res?(t.Alert("success","发货成功"),$("#send-modal").modal("hide"),setTimeout(function(){location.reload()},2e3)):($("#send-modal").modal("hide"),t.Alert("","发货失败"))})}})}function m(e){$("#cloading").removeClass("hidden");var a=10,i=$("#form-box").serialize();i=i+"&pageSize="+a,i=i+"&invoiceTag="+$("#invoiceTag").val(),i=i+"&paymentId="+$("#paymentId").val(),i=i+"&payState="+$("#payState").val(),i=i+"&logisticsState="+$("#logisticsState").val(),v=i,f=new Object,i=i+"&pageNo="+e;var o=listUrl;t.getMsg(o,i,"post").done(function(e){var a=e.res;if(1==a){e=e.obj,g(e);var r={bootstrapMajorVersion:3,currentPage:1,totalPages:1,itemTexts:function(e,a,t){switch(e){case"first":return"首页";case"prev":return"上一页";case"next":return"下一页";case"last":return"末页";case"page":return a}},onPageClicked:function(e,a,i,r){$("#cloading").removeClass("hidden");var n=v;n=n+"&pageNo="+r,f=new Object,t.getMsg(o,n,"post").done(function(e){g(e.obj)})}};r.totalPages=e.pages,$(".page-sum").html('当前页面总数：<span class="text-333">'+e.pages+'</span> 当前总个数：<span class="text-333">'+e.total+"</span>"),$("#cloading").addClass("hidden"),$("#pagination").bootstrapPaginator(r),$("#pagination li").removeClass("active").eq(i.pageNo-1).addClass("active"),1==r.totalPages?$("#pagination").hide():$("#pagination").show()}else document.getElementById("table-list-tpl").innerHTML="没有数据",$("#cloading").addClass("hidden"),$(".page-sum").html(""),$("#pagination").hide(),document.getElementById("table-list-content").innerHTML="没有数据"})}function g(e){var t=a("table-list-tpl",e);document.getElementById("table-list-content").innerHTML=t}var v="",f=new Object;s(),listUrl=apiUrl+"/admin/order/orderAdmin/getOrderPageByOrderAdminSearchVO",m(1),$("#submit-btn-query").on("click",function(){m(1)}),require(["./table"]);var b,y,h,k="",M="";$("#exportdata").click(function(){var e=v;if(1==$("#checkAll").is(":checked"))e=v+"&checkAll=1";else{if(void 0==f||"{}"==JSON.stringify(f))return void alert("请选择导出范围！");e=v+"&selectIdListData="+JSON.stringify(f)}window.location=apiUrl+"/admin/order/orderAdmin/exportPageByOrderAdminSearchVO?"+e}),$("#table-list-content").on("click",".orderIdCheck",function(){var e=$(this).attr("value");1==$("#check_"+e).is(":checked")?f[e]=e:delete f[e]}),$("#table-list-content").on("click",".send-modal",function(){b=$(this).attr("oid"),y=$(this).attr("oNum"),h=$(this).attr("logisticsState"),$("#orderId").val(b),$("#send-modal").modal({show:!0}),1==h?(k=apiUrl+"/admin/order/orderAdmin/toSend",$("#title_name").text("配送信息"),$("#sub").text("马上配送")):2==h?(k=apiUrl+"/admin/order/orderAdmin/receiveGoods",$("#title_name").text("确认已收货"),$("#sub").val("确认收货")):3==h&&(k=apiUrl+"/admin/order/orderAdmin/receiveMoney",$("#sub").val("确认")),l(y)}),$("#table-list-content").on("click",".surplus-modal",function(){b=$(this).attr("oid"),y=$(this).attr("oNum"),h=$(this).attr("logisticsState"),k=apiUrl+"/admin/order/orderAdmin/receiveMoney",$("#surplus-modal").modal({show:!0}),d(y)}),c(),p(),u(),$("#btn_cancel").click(function(){$("#send-modal").modal("hide")}),m(1)});